---
layout: vimdoc
helpname: 'tips'
---
<div id='vimCodeElement'>
<span class="MissingTag">tips.txt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;For&nbsp;<span class="Identifier">Vim バージョン 8.1.</span>&nbsp;&nbsp;Last change: 2009 Nov 07<br>
<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Identifier">VIMリファレンスマニュアル&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; by Bram Moolenaar</span><br>
<br>
<br>
Vim を使うときのヒントとアイデア&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">tips</span><br>
<br>
これは、多くのユーザーにとって便利だろうと思うことの一部です。wiki には<br>
もっと多くの tips があります。<span class="Constant"><a href="http://www.vim.org">http://www.vim.org</a></span><br>
<br>
ユーザーマニュアルも参照してください。ユーザーマニュアルにはたくさんのtipsが含<br>
まれています<span class="MissingTag">usr_toc.txt</span>。<br>
<br>
C のプログラムを編集する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">C-editing</span><br>
識別子が使われている場所を検索する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">ident-search</span><br>
xterm でのスクリーンの切り替え&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">xterm-screens</span><br>
挿入モードでスクロールさせる&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">scroll-insert</span><br>
スムーズにスクロールさせる&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">scroll-smooth</span><br>
ありがちなタイプミスを修正する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">type-mistakes</span><br>
単語や行の数を数える&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">count-items</span><br>
カーソルの位置を戻す&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">restore-position</span><br>
ファイルをリネームする&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">rename-files</span><br>
複数ファイル中の名前を置換する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">change-name</span><br>
外部コマンドの実行速度を速くする&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">speed-up</span><br>
便利なマッピング&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">useful-mappings</span><br>
ヘルプファイルを圧縮する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">gzip-helpfile</span><br>
ウィンドウでシェルコマンドを実行する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">shell-window</span><br>
バイナリ編集&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">hex-editing</span><br>
オートコマンドで &lt;&gt; 表記を使う&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">autocmd-&lt;&gt;</span><br>
対応する括弧を強調する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">match-parens</span><br>
<br>
<span class="PreProc">==============================================================================</span><br>
C のプログラムを編集する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">C-editing</span><br>
<br>
Vim には C のプログラムファイルを編集するのを手助けする機能がたくさんあります。<br>
詳細をジャンプして確認できるようにタグつきで機能のあらましを紹介しましょう。<br>
<br>
<span class="MissingTag">usr_29.txt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ユーザーマニュアルの「プログラム内の移動」<br>
<span class="MissingTag">usr_30.txt</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ユーザーマニュアルの「プログラムの編集」<br>
<span class="MissingTag">C-indenting</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; テキストをタイプ中、自動的に行をインデントします。<br>
<span class="MissingTag">=</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 数行をインデントし直します。<br>
<span class="MissingTag">format-comments</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; コメントを自動的にフォーマットします。<br>
<br>
<span class="MissingTag">:checkpath</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;再帰的にインクルードされるファイルをすべて表示します。<br>
<span class="MissingTag">[i</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;カーソルの下にある単語と同じものを現在のファイルとイン<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;クルードされるファイルから探します。<br>
<span class="MissingTag">[_CTRL-I</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;[i&quot; でマッチした場所にジャンプします。<br>
<span class="MissingTag">[I</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;カーソルの下にある単語と同じものを現在のファイルとイン<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;クルードされるファイルから探し出しその行のリストを表示<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;します。<br>
<br>
<span class="MissingTag">[d</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;カーソルの下の単語の定義を現在のファイルとインクルード<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;されるファイルから探します<br>
<span class="MissingTag">CTRL-]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;カーソルの下のタグにジャンプします。(例、関数の定義)<br>
<span class="MissingTag">CTRL-T</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="Special">CTRL-]</span>コマンドの前に戻ります。<br>
<span class="MissingTag">:tselect</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;マッチしたタグのリストから一つ選びます。<br>
<br>
<span class="MissingTag">gd</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;カーソルの下のローカル変数の宣言にジャンプする。<br>
<span class="MissingTag">gD</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;カーソルの下のグローバル変数の宣言にジャンプする。<br>
<br>
<span class="MissingTag">gf</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;カーソルの下のファイル名にジャンプする。<br>
<br>
<span class="MissingTag">%</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 対応する(),{},[],/* */, #if, #else, #endifに移動する。<br>
<span class="MissingTag">[/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;前のコメントが始まる場所に移動する。<br>
<span class="MissingTag">]/</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;次のコメントが終わる場所に移動する。<br>
<span class="MissingTag">[#</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;前の閉じられていない #if, #ifdef, #else に移動する。<br>
<span class="MissingTag">]#</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;次の閉じられていない #else, #endif に移動する。<br>
<span class="MissingTag">[(</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;前の閉じられていない '(' に移動する。<br>
<span class="MissingTag">])</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;次の閉じられていない ')' に移動する。<br>
<span class="MissingTag">[{</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;前の閉じられていない '{' に移動する。<br>
<span class="MissingTag">]}</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;次の閉じられていない '}' に移動する。<br>
<br>
<span class="MissingTag">v_ab</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;「ブロック(&quot;[(&quot;から&quot;])&quot;まで)」を括弧を含めて選択する。<br>
<span class="MissingTag">v_ib</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;「ブロック(&quot;[(&quot;から&quot;])&quot;まで)の内部」を選択する。<br>
<span class="MissingTag">v_aB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;「ブロック(&quot;[{&quot;から&quot;]}&quot;まで)」を括弧を含めて選択する。<br>
<span class="MissingTag">v_iB</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;「ブロック(&quot;[{&quot;から&quot;]}&quot;まで)の内部」を選択する。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
識別子が使われている場所を検索する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">ident-search</span><br>
<br>
<span class="MissingTag">tags</span>が関数や変数の定義された場所へのジャンプに使えることはすでにわかりました<br>
が、ときどき関数や変数が使われている場所にジャンプしたいことがあります。これ<br>
は二つの方法で実現することができます:<br>
1.&nbsp;<span class="MissingTag">:grep</span>を使う方法。この方法はほとんどの Unix システムでうまく動作しますが遅<br>
&nbsp;&nbsp; いですし(全てのファイルを読むため)、一つのディレクトリの中だけしか検索でき<br>
&nbsp;&nbsp; ません。<br>
2. ID ユーティリティを使う方法。この方法は速いですし複数のディレクトリを検索で<br>
&nbsp;&nbsp; きます。この方法は位置を記憶するためにデータベースを使用します。いくつかの<br>
&nbsp;&nbsp; プログラムを新たに入れる必要があります。そして、データベースを最新に保つこ<br>
&nbsp;&nbsp; とが要求されます。<br>
<br>
GNU id-tools と Vim を連動させる。<br>
<br>
必要なもの:<br>
- The GNU id-toolsがインストールされていること(IDを生成するにはmkidが必要でマ<br>
&nbsp;&nbsp;クロを使うのにlidが必要です)。<br>
- 現在のディレクトリに &quot;ID&quot; と呼ばれる識別子データベースファイルがあること。<br>
&nbsp;&nbsp;シェルコマンド &quot;mkid file1 file2 ..&quot; で作成可能です。<br>
<br>
次の行を .vimrc に追加してください。<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map _u :call ID_search()&lt;Bar&gt;execute &quot;/\\&lt;&quot; . g:word . &quot;\\&gt;&quot;&lt;CR&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;map _n :n&lt;Bar&gt;execute &quot;/\\&lt;&quot; . g:word . &quot;\\&gt;&quot;&lt;CR&gt;</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function! ID_search()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let g:word = expand(&quot;&lt;cword&gt;&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let x = system(&quot;lid --key=none &quot;. g:word)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let x = substitute(x, &quot;\n&quot;, &quot; &quot;, &quot;g&quot;)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execute &quot;next &quot; . x<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endfun</div>
<br>
これを使うには、単語上にカーソルを置いて、&quot;_u&quot; とタイプすればvimは単語を含んだ<br>
ファイルを読みこみます。同じファイルで次に単語が出てくるところを検索するには<br>
&quot;n&quot; をタイプします。&quot;_n&quot; で次のファイルに行きます。<br>
<br>
この方法は id-utils-3.2 を使って動作を確認しました (id-utlis-3.2 は id-tools<br>
アーカイブの名前です。近くの gnu-ftp-mirror から入手してください。)<br>
<br>
[このアイデアはAndreas Kutscheraさんから頂いたものです]<br>
<br>
<span class="PreProc">==============================================================================</span><br>
xterm でのスクリーンの切り替え&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">xterm-screens</span>&nbsp;<span class="MissingTag">xterm-save-screen</span><br>
<br>
(comp.editors で質問に答えて Juergen Weigert 氏が投稿したもの)<br>
<br>
:&gt; もう一つの質問は vim を終了させた後にスクリーンがそのまま残っている<br>
:&gt; ことに関してです。例えばいままで見ていた(編集していた)内容がスクリ<br>
:&gt; ーンに残っていますよね。そして前に行った ls などのコマンドの出力が<br>
:&gt; 消えてしまうのです(例えばスクロールバッファからなくなってしまう)。<br>
:&gt; vim や他の vi 風のエディタでもどうにかして前の画面を復元する方法が<br>
:&gt; あるとは思うのですが、どのようにすれば実現できるのかわかりません。<br>
:&gt; 教えていただけると嬉しいです。それでは。<br>
:<br>
:どなたか詳しい方が答えて下さると思います。vim も vi も xterm の設定を<br>
:みて同じことをそれぞれやっていると思うのですが。<br>
<br>
これらは必ずしも同じ動作をするとは限りません、というのはこれは termcap と<br>
terminfo の問題であるかもしれないからです。個々のタイプのターミナルの属性を記<br>
述するデータベースには termcap と terminfoという二つのデータベースがあるという<br>
ことを知っておいてください。エントリが異なっていて、かつ質問にあったプログラム<br>
のどれかが termcap を使っていて他のものが terminfo を使っていた場合、違う動作<br>
をすることになりえます。<br>
(<span class="MissingTag">+terminfo</span>&nbsp;も参照してください)<br>
<br>
この問題の場合、^[[?47h と ^[[?47l というコントロールシーケンスが答えになりま<br>
す。これらはxtermのメインスクリーンバッファともう一方のバッファを切り替えるの<br>
に用いられます。簡単に動作させてみるには次のコマンドを打ってみてください、<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;echo -n &quot;^[[?47h&quot;; vim ... ; echo -n &quot;^[[?47l&quot;</div>
あなたが望む動作はこれかもしれません。 (ここで ^[ は ESC キャラクターを意味し<br>
ます。このあとデータベースではこの記号の代わりに \E を使っていることがわかるで<br>
しょう)<br>
<br>
起動時に vim は termcap の ti 変数 (terminfo の場合: smcup) の値を echo し、終<br>
了時には te 変数 (terminfo の場合: rmcup) の値をターミナルに echo します。とい<br>
うわけで、これらの二つの変数が上記のコントロールシーケンスを設定する正しい場所<br>
です。<br>
<br>
xterm の termcap エントリ (/etc/termcap にあります) と xterm の terminfo エン<br>
トリ (infocmp -C xterm として入手します) とを比べてみてください。双方に次のよ<br>
うなエントリが含まれている必要があります。<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:te=\E[2J\E[?47l\E8:ti=\E7\E[?47h:</div>
<br>
追伸: もしなんらかの違いを見つけた場合、だれかが(システム管理者かな?) termcap<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;と terminfo データベースを継続的にチェックするようにした方がよいです。<br>
<br>
注1: feature.h で定義される FEAT_XTERM_SAVE をつけて Vim を再コンパイルすると<br>
内蔵の xterm は上記の &quot;te&quot; と &quot;ti&quot; エントリを含むようになります。<br>
<br>
注2: スクリーンのスイッチを行わないようにし、termcap の変更も行いたくない場合<br>
次の行を .vimrc に加えてください。<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set t_ti= t_te=</div>
<br>
<span class="PreProc">==============================================================================</span><br>
挿入モードでスクロールを行う&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">scroll-insert</span><br>
<br>
挿入モードでスクリーンの外の部分を見たい場合、<span class="Special">CTRL-X</span>&nbsp;<span class="Special">CTRL-E</span>&nbsp;と&nbsp;<span class="Special">CTRL-X</span>&nbsp;<span class="Special">CTRL-Y</span><br>
を使うことでスクリーンをスクロールさせることができます。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">i_CTRL-X_CTRL-E</span><br>
<br>
これを簡単に行うには次のマッピングをすることができます:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:inoremap &lt;C-E&gt; &lt;C-X&gt;&lt;C-E&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:inoremap &lt;C-Y&gt; &lt;C-X&gt;&lt;C-Y&gt;</div>
(文字通り入力するには、'&lt;' フラグが&nbsp;<span class="MissingTag">'cpoptions'</span>&nbsp;にないことを確認してください)<br>
しかしこれを行うとカーソルの上/下の行のテキストをコピーする機能が使えなくなり<br>
ます。<br>
<span class="MissingTag">i_CTRL-E</span>.<br>
<br>
カーソルの周りの前後を常に見渡せるように&nbsp;<span class="MissingTag">'scrolloff'</span>&nbsp;オプションの値を大きい値<br>
に設定するのもよいです。<span class="MissingTag">'scrolloff'</span>&nbsp;の値がウィンドウの高さの半分以上に設定さ<br>
れているとカーソルが常にスクリーンの中央にあることになりテキストはカーソルの<br>
上下移動にあわせてスクロールすることになります。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
スムーズにスクロールさせる&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">scroll-smooth</span><br>
<br>
もう少しスムーズにスクロールさせたい場合、次のマッピングを使うこともできます:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:map &lt;C-U&gt; &lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;&lt;C-Y&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:map &lt;C-D&gt; &lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;&lt;C-E&gt;</div>
<br>
(文字通り入力するには、'&lt;' フラグが&nbsp;<span class="MissingTag">'cpoptions'</span>&nbsp;にないことを確認してください)<br>
<br>
<span class="PreProc">==============================================================================</span><br>
ありがちなタイプミスを修正する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">type-mistakes</span><br>
<br>
しょっちゅう間違ってタイプする単語がいくつかあれば、短縮入力を修正するのに利用<br>
しましょう。例えば:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:ab teh the<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:ab fro for</div>
<br>
<span class="PreProc">==============================================================================</span><br>
単語や行などの数を数える&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">count-items</span><br>
<br>
カレントバッファの中になんらかのパターンがどのくらいの回数現れるのかを数えるに<br>
は、substituteコマンドを使い、実際に置換するのを避けるためにフラグ 'n' をつけ<br>
ます。報告される数がそのアイテムの数です。例:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:%s/./&amp;/gn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;文字<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:%s/\i\+/&amp;/gn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 単語<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:%s/^//n&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;行<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:%s/the/&amp;/gn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;the&quot; (どこかしら)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:%s/\&lt;the\&gt;/&amp;/gn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;the&quot; (単語一致)</div>
<br>
<span class="MissingTag">'hlsearch'</span>&nbsp;をリセットするか、&quot;:nohlsearch&quot; をしたくなるかもしれません。<br>
マッチが1個もないときにエラーになってほしくなければフラグ 'e' をつけます。<br>
<br>
別の方法としては、ビジュアルモードで<span class="MissingTag">v_g_CTRL-G</span>を使います。<br>
<br>
複数のファイルから検索したければ<span class="MissingTag">:vimgrep</span>を使います。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">count-bytes</span><br>
バイト数を数えるにはこれを使ってください。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;文字列を選択してください(ブロック選択も使えます)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;y&quot; でコピーしてください<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;そして、strlen()を使います<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:echo strlen(@&quot;)</div>
改行は1バイトとして数えられます。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
カーソルの位置を戻す&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">restore-position</span><br>
<br>
ときにはファイルのどこかに変更を加えて、テキストをスクロールすることなくカーソ<br>
ルを元の位置に戻すようなマッピングを書きたくなることがあります。ファイルに書い<br>
た日付を変更する例をあげます:<br>
<div class="helpExample">&nbsp;&nbsp; :map &lt;F2&gt; msHmtgg/Last [cC]hange:\s*/e+1&lt;CR&gt;&quot;_D&quot;=strftime(&quot;%Y %b %d&quot;)&lt;CR&gt;p'tzt`s</div>
<br>
位置を記憶する:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ms&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'s' マークにカーソルの位置を記録します<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ウィンドウに表示された最初の行に移動します<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;その行を 't' マークに記録します<br>
<br>
位置を元に戻す:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;先程のウィンドウに表示された最初の行に移動します<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;その行がウィンドウの最初に表示されるようにスクロールします<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;`s&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;最初の位置に戻ります<br>
<br>
より高度なことについては&nbsp;<span class="MissingTag">winsaveview()</span>&nbsp;と&nbsp;<span class="MissingTag">winrestview()</span>&nbsp;を参照してくださ<br>
い。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
ファイルをリネームする&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">rename-files</span><br>
<br>
例えば以下のようなファイルを含むディレクトリがあるとします(ディレクトリはラン<br>
ダムに選び出したものです :-):<br>
<br>
buffer.c<br>
charset.c<br>
digraph.c<br>
...<br>
<br>
そして *.c を *.bla にリネームしたい場合次のようなコマンドを実行します:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ vim<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:r !ls *.c<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:%s/\(.*\).c/mv &amp; \1.bla<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:w !sh<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:q!</div>
<br>
<span class="PreProc">==============================================================================</span><br>
複数ファイル中の名前を置換する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">change-name</span><br>
<br>
スクリプトファイルを使って複数ファイル中の名前を置換する例です:<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;以下のように置換コマンドと :update コマンドを含む &quot;subs.vim&quot; というファ<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;イルを作成します:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:%s/Jones/Smith/g<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:%s/Allen/Peter/g<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:update</div>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Vim で置換したい全ファイルを開き、各引数に対してこのスクリプトを実行<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;します:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;vim *.let<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;argdo source subs.vim</div>
<br>
<span class="MissingTag">:argdo</span>&nbsp;も参照。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
外部コマンドの実行をスピードアップする&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">speed-up</span><br>
<br>
いくつかの状況では外部コマンドの実行速度が非常に遅くなる場合があります。これは<br>
Unix でのワイルドカード展開が行われた場合もそうです。いくつかのスピードアップ<br>
する方法を紹介しましょう。<br>
<br>
もし .cshrc (もしくは他のファイル、使っているシェルによります)が非常に長いなら<br>
ばそれを対話的に使う部分とそうでない用途(セカンダリーシェルとよく呼ばれます)の<br>
部分にわけるべきです。Vim から &quot;:!ls&quot; のようなコマンドを実行する場合、対話的に<br>
行う必要はありませんよね(例えば、プロンプトを出させたり)。次の行の後にそれらを<br>
おくようにしてください。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($?prompt == 0) then<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif</div>
<br>
もう一つの方法は&nbsp;<span class="MissingTag">'shell'</span>&nbsp;オプションに &quot;-f&quot; フラグをつける方法です、例えば:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:set shell=csh\ -f</div>
<br>
(オプションの中にスペースを含めるにはバックスラッシュが必要です)<br>
こうすると csh が .cshrc ファイルを読み込まないようにすることができます。しか<br>
しこうすることでなんらかが動作しない場合もあるかもしれません。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
便利なマッピング&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">useful-mappings</span><br>
<br>
ここでいくつか好んで使われるマッピングを紹介します。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">map-backtick</span>&nbsp;<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:map ' `</div>
シングル引用符の動作をバック引用符の動作のようにします。カーソルをマークがある<br>
行の最初の非空白文字に移動させるのではなく、マークがある桁位置に移動させます。<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">emacs-keys</span><br>
コマンドラインでのキーバインドを Emacs スタイルにします:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; 行頭へ移動<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:cnoremap &lt;C-A&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Home&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; 一文字戻る<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:cnoremap &lt;C-B&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Left&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; カーソルの下の文字を削除<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:cnoremap &lt;C-D&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Del&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; 行末へ移動<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:cnoremap &lt;C-E&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;End&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; 一文字進む<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:cnoremap &lt;C-F&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Right&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; コマンドライン履歴を一つ進む<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:cnoremap &lt;C-N&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Down&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; コマンドライン履歴を一つ戻る<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:cnoremap &lt;C-P&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Up&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; 前の単語へ移動<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:cnoremap &lt;Esc&gt;&lt;C-B&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;S-Left&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; 次の単語へ移動<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:cnoremap &lt;Esc&gt;&lt;C-F&gt;&nbsp;&nbsp;&nbsp;&nbsp;&lt;S-Right&gt;</div>
<br>
<span class="Todo">NOTE</span>: これを利用するには&nbsp;<span class="MissingTag">'cpoptions'</span>&nbsp;から '&lt;' フラグを外しておく必要がありま<br>
す。<span class="MissingTag">&lt;&gt;</span><br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">format-bullet-list</span><br>
このマッピングはブレットリストのフォーマットを整えるものです。それぞれのリスト<br>
のエントリの前後に空行がある必要があります。式が使われているのはマッピングを部<br>
分的に解説するコメントを入れるためです。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:let m =&nbsp;&nbsp;&nbsp;&nbsp; &quot;:map _f&nbsp;&nbsp;:set ai&lt;CR&gt;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&quot; 'autoindent' をセット<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:let m = m . &quot;{O&lt;Esc&gt;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; アイテムの上に空行を挿入<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:let m = m . &quot;}{)^W&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; ブレットの後のテキストに移動<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:let m = m . &quot;i&nbsp;&nbsp;&nbsp;&nbsp;&lt;CR&gt;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Esc&gt;&quot;&nbsp;&nbsp;&nbsp;&nbsp;&quot; インデントの為のスペースを挿入<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:let m = m . &quot;gq}&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; ブレットの後のテキストを整形<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:let m = m . &quot;{dd&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; 空行を削除<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:let m = m . &quot;5lDJ&quot;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &quot; ブレットの後にテキストを置く<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:execute m&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|&quot; マッピングを決定する</div>
<br>
(&lt;&gt; 表記法&nbsp;<span class="MissingTag">&lt;&gt;</span>。これらは文字どおりにタイプするということに注意してください。<br>
^W は &quot;^&quot; &quot;W&quot; で&nbsp;<span class="Special">CTRL-W</span>&nbsp;ではありません。<span class="MissingTag">'cpoptions'</span>&nbsp;に '&lt;' がなければ Vim にコ<br>
ピー/ペーストすることができますよ。)<br>
<br>
最後のコメントは |&quot; で始まっていることに注意してください、これは &quot;:execute&quot; コ<br>
マンドが直接のコメントを受け付けないからです。<br>
<br>
また&nbsp;<span class="MissingTag">'textwidth'</span>&nbsp;を 0 以外の値にしておく必要があります。例えば:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set tw=70</div>
<br>
最初の行からインデントすることになりますが次のようなマッピングでも同じことがで<br>
きます (<span class="Todo">Note</span>: このマッピングは多くのスペースを含む長い一つの行です):<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:map _f :set ai&lt;CR&gt;}{a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;Esc&gt;WWmmkD`mi&lt;CR&gt;&lt;Esc&gt;kkddpJgq}'mJO&lt;Esc&gt;j</div>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">collapse</span><br>
これら2つのマッピングは空行(;b)もしくは空白文字のみからなる行(;n)の連続を1行に<br>
します。<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp; :map ;b&nbsp;&nbsp; GoZ&lt;Esc&gt;:g/^$/.,/./-j&lt;CR&gt;Gdd<br>
&nbsp;&nbsp;&nbsp;&nbsp; :map ;n&nbsp;&nbsp; GoZ&lt;Esc&gt;:g/^[ &lt;Tab&gt;]*$/.,/[^ &lt;Tab&gt;]/-j&lt;CR&gt;Gdd</div>
<br>
<span class="PreProc">==============================================================================</span><br>
ヘルプファイルを圧縮する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">gzip-helpfile</span><br>
<br>
ディスクスペースに空きがあまりない人はヘルプファイルを圧縮することができます。<br>
圧縮した後でもヘルプファイルを閲覧することはできます。ヘルプファイルへのアクセ<br>
スは少し遅くなります。また &quot;gzip&quot; プログラムが必要です。<br>
<br>
(1) すべてのヘルプファイルを圧縮するには: &quot;gzip doc/*.txt&quot;<br>
<br>
(2) &quot;doc/tags&quot; を編集して &quot;.txt&quot; を &quot;.txt.gz&quot; にします。<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:%s=\(\t.*\.txt\)\t=\1.gz\t=</div>
<br>
(3) 次の行を vimrc に追加します:<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set helpfile={dirname}/help.txt/gz</div>
<br>
<span class="Special">{dirname}</span>はヘルプファイルのある場所です。<span class="MissingTag">gzip</span>プラグインがファイルの解凍をし<br>
ます。それともし圧縮された &quot;doc&quot; ディレクトリと同じ場所に他のVim ファイルがな<br>
い場合、$VIMRUNTIME が他の Vim ファイルがある場所になるようにしておかなければ<br>
なりません。<span class="MissingTag">$VIMRUNTIME</span>も参照してください。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
ウィンドウでシェルコマンドを実行する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">shell-window</span><br>
<br>
Vim の中のウィンドウでシェルを起動できるかという質問がいままでに何度かありまし<br>
た。答えは、できないです。もしこれを実装しようとすればかなり多くのコードを加え<br>
なければなりません、これが実装しない理由です。つまるところ、Vim はエディタなの<br>
です、エディタとしてではない作業を実行するようには考えられていません。しかしな<br>
がら、同じようなことを実行するには &quot;splitvt&quot; プログラムを使って端末のスクリー<br>
ンもしくはウィンドウの表示を分割することができます。このプログラムはたぶんどこ<br>
かの ftp サーバーで見つけることができると思います。このプログラムに詳しいのは<br>
Sam Lantinga &lt;slouken@cs.ucdavis.edu&gt; です。もう一つの方法は &quot;window&quot; コマンド<br>
を利用する方法で、このコマンドは BSD Unix システムにあります。このコマンドは複<br>
数のウィンドウをオーバーラップさせることができます。それか &quot;screen&quot; プログラム<br>
を使うかです。これは&nbsp;<span class="Constant">www.uni-erlangen.de</span>&nbsp;で見つけることができ、このプログラム<br>
でウィンドウの積み重ねをすることができます。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
バイナリ編集&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">hex-editing</span>&nbsp;<span class="MissingTag">using-xxd</span><br>
<br>
ユーザーマニュアルの<span class="MissingTag">23.4</span>を参照してください。<br>
<br>
もしそのファイルがバイナリファイル特有の拡張子(exe、binなど)をしているときは、<br>
あなたの&lt;.vimrc&gt;に次のオートコマンドを加えることで、変換の過程を自動化しておく<br>
こともできます。&quot;*.bin&quot; をあなたの編集したいファイルの拡張子の、コンマで区切ら<br>
れたリストに変えてください:<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot; vim -b : edit binary using xxd-format!<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;augroup Binary<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;au!<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;au BufReadPre&nbsp;&nbsp;*.bin let &amp;bin=1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;au BufReadPost *.bin if &amp;bin | %!xxd<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;au BufReadPost *.bin set ft=xxd | endif<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;au BufWritePre *.bin if &amp;bin | %!xxd -r<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;au BufWritePre *.bin endif<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;au BufWritePost *.bin if &amp;bin | %!xxd<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;au BufWritePost *.bin set nomod | endif<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;augroup END</div>
<br>
<span class="PreProc">==============================================================================</span><br>
オートコマンドで &lt;&gt; 表記を使う&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">autocmd-&lt;&gt;</span><br>
<br>
&lt;&gt; 表記は :autocmd の引数として使っても正しく解釈されません。特殊な文字を入力<br>
するのを避けるには、&lt;&gt; 表記をするための自己破壊的なマッピング行ってそれからオー<br>
トコマンドの中でそのマッピングを呼び出すことで実現することもできます。例:<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">map-self-destroy</span>&nbsp;<br>
<div class="helpExample">&nbsp;&quot; この方法はファイル名を自動的にメニューリストに追加するものです。<br>
&nbsp;&quot; 自己破壊的なマッピングを使っています!<br>
&nbsp;&quot; 1. ファイル名に含まれる 'dots' を \. に変更するためにバッファの一つの行を使<br>
&nbsp;&quot;&nbsp;&nbsp;&nbsp;&nbsp;います。<br>
&nbsp;&quot; 2. それをレジスタ '&quot;' に格納します。<br>
&nbsp;&quot; 3. その名前をバッファメニューリストに追加します。<br>
&nbsp;&quot; 警告: この方法にはいくらか副作用があります。現在のレジスタの内容を上書きし<br>
&nbsp;&quot; たり &quot;i&quot; コマンドへのマッピングをすべて削除してしまったりします。<br>
&nbsp;&quot;<br>
&nbsp;autocmd BufNewFile,BufReadPre * nmap i :nunmap i&lt;CR&gt;O&lt;C-R&gt;%&lt;Esc&gt;:.g/\./s/\./\\./g&lt;CR&gt;0&quot;9y$u:menu Buffers.&lt;C-R&gt;9 :buffer &lt;C-R&gt;%&lt;C-V&gt;&lt;CR&gt;&lt;CR&gt;<br>
&nbsp;autocmd BufNewFile,BufReadPre * normal i</div>
<br>
もう一つのよりよい方法は &quot;:execute&quot; コマンドを使う方法です。文字列の中ではバッ<br>
クスラッシュを前置することで &lt;&gt; 表記が使えます。それまであったバックスラッシュ<br>
は \\ という風に2回重ねるのを忘れないでください。また '&quot;' の前にもバックスラッ<br>
シュを前置しなければなりません。<br>
<br>
<div class="helpExample">&nbsp;autocmd BufNewFile,BufReadPre * exe &quot;normal O\&lt;C-R&gt;%\&lt;Esc&gt;:.g/\\./s/\\./\\\\./g\&lt;CR&gt;0\&quot;9y$u:menu Buffers.\&lt;C-R&gt;9 :buffer \&lt;C-R&gt;%\&lt;C-V&gt;\&lt;CR&gt;\&lt;CR&gt;&quot;</div>
<br>
実際のバッファメニューではユーザー定義関数を使うべきですが(<span class="MissingTag">:function</span>を参照)、<br>
そうすると&lt;&gt;表記は使いませんので、ここでの例としてそれを使うのは不適切です。<br>
<br>
<span class="PreProc">==============================================================================</span><br>
対応する括弧を強調する&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="MissingTag">match-parens</span><br>
<br>
この例はいくつかの高度なトリックを紹介しています。<br>
- 自動コマンドイベント<span class="MissingTag">CursorMoved</span>の使い方<br>
-&nbsp;<span class="MissingTag">searchpairpos()</span>を使って対応する括弧を見つける方法<br>
-&nbsp;<span class="MissingTag">synID()</span>を使ってカーソルが文字列やコメントの中にあるかを判定する方法<br>
-&nbsp;<span class="MissingTag">:match</span>を使って何かを強調する方法<br>
-&nbsp;<span class="MissingTag">pattern</span>を使ってファイルの特定の位置にマッチさせる方法<br>
<br>
これはスクリプトローカル変数を使っているので、Vim script ファイル中に書かなけ<br>
ればなりません。カーソルが文字列やコメントの中にないならば、文字列やコメントは<br>
スキップして検索します。構文強調が有効になっている必要があります。<br>
<br>
これより若干高度なバージョンがプラグイン<span class="MissingTag">matchparen</span>の中で使われています。<br>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let s:paren_hl_on = 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;function s:Highlight_Matching_Paren()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if s:paren_hl_on<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match none<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let s:paren_hl_on = 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let c_lnum = line('.')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let c_col = col('.')</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let c = getline(c_lnum)[c_col - 1]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let plist = split(&amp;matchpairs, ':\|,')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let i = index(plist, c)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if i &lt; 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if i % 2 == 0<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let s_flags = 'nW'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let c2 = plist[i + 1]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let s_flags = 'nbW'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let c2 = c<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let c = plist[i - 1]<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if c == '['<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let c = '\['<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let c2 = '\]'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let s_skip ='synIDattr(synID(line(&quot;.&quot;), col(&quot;.&quot;), 0), &quot;name&quot;) ' .<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\ '=~?&nbsp;&nbsp;&quot;string\\|comment&quot;'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;execute 'if' s_skip '| let s_skip = 0 | endif'</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let [m_lnum, m_col] = searchpairpos(c, '', c2, s_flags, s_skip)</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if m_lnum &gt; 0 &amp;&amp; m_lnum &gt;= line('w0') &amp;&amp; m_lnum &lt;= line('w$')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exe 'match Search /\(\%' . c_lnum . 'l\%' . c_col .<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\ 'c\)\|\(\%' . m_lnum . 'l\%' . m_col . 'c\)/'<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;let s:paren_hl_on = 1<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endif<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;endfunction</div>
<br>
<div class="helpExample">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;autocmd CursorMoved,CursorMovedI * call s:Highlight_Matching_Paren()<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;autocmd InsertEnter * match none</div>
&nbsp;&nbsp;<br>
<br>
&nbsp;vim:tw=78:ts=8:ft=help:norl:<br>
</div>
